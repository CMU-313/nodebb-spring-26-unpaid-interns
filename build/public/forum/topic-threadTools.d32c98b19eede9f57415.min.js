"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[22765,37418,75264,85940],{2269(W,L){var s,C;s=[],C=(function(){const v={},r=/-resized(\.[\w]+)?$/;return v.wrapImagesInLinks=function(m){m.find('[component="post/content"] img:not(.emoji)').each(function(){v.wrapImageInLink($(this))})},v.wrapImageInLink=function(m){let w=m.attr("src")||"";if(w!=="about:blank"&&!m.parent().is("a")){utils.isRelativeUrl(w)&&r.test(w)&&(w=w.replace(r,"$1"));const R=m.attr("alt")||"",h=w.split(".").slice(1).pop(),y=R.split("/").pop(),A=y.split(".").slice(1).pop();m.wrap('<a href="'+w+'" '+(!h&&A?' download="'+utils.escapeHTML(y)+'" ':"")+' target="_blank" rel="noopener">')}},v}).apply(L,s),C!==void 0&&(W.exports=C)},22410(W,L,s){var C,v;C=[s(91749),s(29930),s(49897)],v=(function(r,m,w){const R={};let h,y=0,A=!1,P,T=0;R.init=function(o,c){const n=$("body");typeof o=="function"?(h=o,P=n):(h=c,P=o||n),y=$(window).scrollTop(),$(window).off("scroll",l).on("scroll",l),n.height()<=$(window).height()&&(!ajaxify.data.hasOwnProperty("pageCount")||ajaxify.data.pageCount>1)&&h(1)};function l(){T&&clearTimeout(T),T=setTimeout(function(){T=0,d()},60)}function d(){if(E())return;const o=D(),c=U(o.currentScrollTop);e(o)&&h(c),y=o.currentScrollTop}function E(){const o=utils.findBootstrapEnvironment(),c=(o==="xs"||o==="sm")&&$("html").hasClass("composing");return A||c||app.flags._glance}function D(){const o=$(window).scrollTop(),c=$(window).height(),n=P.offset(),a=n?n.top:0,f=P.height()-c,g=f<=0?c:f,I=100*(o-a)/g;return{currentScrollTop:o,viewportHeight:f,scrollPercent:I}}function U(o){return o>y?1:-1}function e(o){const a=o.currentScrollTop<y,f=o.currentScrollTop>y;return!!(o.scrollPercent<15&&a||o.scrollPercent>85&&f||o.scrollPercent<0&&f&&o.viewportHeight<0)}return R.loadMore=function(o,c,n){if(A)return;A=!0;const a={method:o,data:c};r.fire("action:infinitescroll.loadmore",a),(a.method.startsWith("/")?w.get:socket.emit)(a.method,a.data,function(g,I){if(g)return A=!1,m.error(g);n(I,function(){A=!1})})},R.loadMoreXhr=function(o,c){if(A)return;A=!0;const n=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),a={url:n,data:o};r.fire("action:infinitescroll.loadmore.xhr",a),$.get(n,o,function(f){c(f,function(){A=!1})}).fail(function(f){A=!1,m.error(String(f.responseJSON||"[[error:no-connection]]"))})},R.removeExtra=function(o,c,n){let a=$();if(o.length<=n)return a;const f=o.length-n;if(c>0){const g=$(document).height(),I=$(window).scrollTop();a=o.slice(0,f).remove(),$(window).scrollTop(I+($(document).height()-g))}else a=o.slice(o.length-f).remove();return a},R}).apply(L,C),v!==void 0&&(W.exports=v)},47536(W,L,s){var C,v;C=[s(25967),s(22410),s(8454),s(2269),s(96352),s(52473),s(17459),s(91749),s(30076)],v=(function(r,m,w,R,h,y,A,P,T){const l={};l.signaturesShown={};const d=$(window);l.onNewPost=function(t){!t||!t.posts||!t.posts.length||String(t.posts[0].tid)!==String(ajaxify.data.tid)||(t.loggedIn=!!app.user.uid,t.privileges=ajaxify.data.privileges,t.posts[0].timestamp=t.posts[0].topic.scheduled?t.posts[0].timestamp:Date.now()-1e3,t.posts[0].timestampISO=utils.toISOString(t.posts[0].timestamp),l.modifyPostsByPrivileges(t.posts),D(t.posts),E(t.posts[0]),U(t.posts),ajaxify.data.postcount+=1,w.updatePostCount(ajaxify.data.postcount),config.usePagination?e(t):c(t),s.e(18631).then(function(){var i=[s(18631)];(function(p){p.onNewPost(t)}).apply(null,i)}).catch(s.oe))};function E(t){$(".pagination-block .pagebottom .timeago").timeago("update",t.timestampISO)}l.modifyPostsByPrivileges=function(t){t.forEach(function(i){i.selfPost=!!app.user.uid&&parseInt(i.uid,10)===parseInt(app.user.uid,10),i.topicOwnerPost=parseInt(i.uid,10)===parseInt(ajaxify.data.uid,10),i.display_edit_tools=ajaxify.data.privileges["posts:edit"]&&i.selfPost||ajaxify.data.privileges.isAdminOrMod,i.display_delete_tools=ajaxify.data.privileges["posts:delete"]&&i.selfPost||ajaxify.data.privileges.isAdminOrMod,i.display_moderator_tools=i.display_edit_tools||i.display_delete_tools,i.display_move_tools=ajaxify.data.privileges.isAdminOrMod,i.display_post_menu=ajaxify.data.privileges.isAdminOrMod||i.selfPost&&!ajaxify.data.locked&&!i.deleted||i.selfPost&&i.deleted&&parseInt(i.deleterUid,10)===parseInt(app.user.uid,10)||(app.user.uid||ajaxify.data.postSharing.length)&&!i.deleted})};function D(t){for(let i=0;i<t.length;i+=1){const p=y.get("user/postcount",t[i].uid);p.html(T.formattedNumber(parseInt(p.attr("data-postcount"),10)+1))}}function U(t){config.topicPostSort==="newest_to_oldest"&&(t[0].index=1,y.get("post").not("[data-index=0]").each(function(){const i=parseInt($(this).attr("data-index"),10)+1;$(this).attr("data-index",i)}))}function e(t){function i(){n(t.posts[0])}const p=t.posts;ajaxify.data.pagination.pageCount=Math.max(1,Math.ceil(p[0].topic.postcount/config.postsPerPage));const u=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1;if(ajaxify.data.pagination.currentPage===ajaxify.data.pagination.pageCount&&u===1||ajaxify.data.pagination.currentPage===1&&u===-1){const M=$('[component="post"]:not([data-index=0]), [component="topic/event"]');a(t,M,u,!1,i)}else ajaxify.data.scrollToMyPost&&parseInt(p[0].uid,10)===parseInt(app.user.uid,10)?setTimeout(function(){r.loadPage(ajaxify.data.pagination.pageCount,i)},250):o()}function o(){$.get(config.relative_path+"/api/topic/pagination/"+ajaxify.data.tid,{page:ajaxify.data.pagination.currentPage},function(t){app.parseAndTranslate("partials/paginator",t,function(i){$('[component="pagination"]').after(i).remove()})})}function c(t){const i=config.topicPostSort==="oldest_to_newest"||config.topicPostSort==="most_votes"?1:-1,p=$('[component="post"][data-index="'+(t.posts[0].index-1)+'"]').length;if(!p&&(!t.posts[0].selfPost||!ajaxify.data.scrollToMyPost))return;if(!p&&t.posts[0].selfPost)return ajaxify.go("post/"+t.posts[0].pid);const u=$('[component="topic"]>[component="post"]:not([data-index=0]), [component="topic"]>[component="topic/event"]');a(t,u,i,!1,function(x){x&&x.addClass("new"),n(t.posts[0])})}function n(t){t.selfPost&&ajaxify.data.scrollToMyPost&&h.scrollBottom(t.index)}function a(t,i,p,u,x){if(x=x||function(){},!t||t.posts&&!t.posts.length)return x();function M(){const S=$('[component="post"].new');if(S.length===t.posts.length){let B=!0;if(S.each(function(j,O){parseInt($(O).attr("data-pid"),10)!==parseInt(t.posts[j].pid,10)&&(B=!1)}),B){S.each(function(){$(this).removeClass("new")}),t.posts.length=0;return}}S.length&&t.posts.length>1&&t.posts.forEach(function(B){const j=y.get("post","pid",B.pid);j.hasClass("new")&&j.remove()}),t.posts=t.posts.filter(function(B){return B.allowDupe||$('[component="post"][data-pid="'+B.pid+'"]').length===0})}if(M(),!t.posts.length)return x();let k,N;p>0&&i.length?k=i.last():p<0&&i.length&&(N=i.first()),P.fire("action:posts.loading",{posts:t.posts,after:k,before:N}),app.parseAndTranslate("topic","posts",Object.assign({},ajaxify.data,t),async function(S){S=S.filter(function(){const j=$(this),O=j.attr("data-pid"),F=j.attr("data-allow-dupe");return!j.is('[component="post"]')||F||O&&$('[component="post"][data-pid="'+O+'"]').length===0});const B=m.removeExtra($('[component="post"]'),p,Math.max(20,config.postsPerPage*2));if(k)S.insertAfter(k);else if(N){const j=$(document).height(),O=d.scrollTop();S.insertBefore(N),(u||O>0)&&d.scrollTop(O+($(document).height()-j))}else y.get("topic").append(S);await l.onNewPostsAddedToDom(S),I(B),P.fire("action:posts.loaded",{posts:t.posts}),x(S)})}l.loadMorePosts=function(t){if(!y.get("topic").length||h.scrollActive)return;const i=y.get("topic").find(y.get("post").not("[data-index=0]").not(".new")),p=t>0?i.last():i.first(),u=parseInt(p.attr("data-index"),10)||0,x=ajaxify.data.tid;if(!utils.isNumber(u)||t<0&&y.get("post","index",0).length)return;const M=$(".loading-indicator");M.is(":animated")||M.fadeIn(),m.loadMore("topics.loadMore",{tid:x,after:u+(t>0?1:0),count:config.postsPerPage,direction:t,topicPostSort:utils.params().sort||config.topicPostSort},function(k,N){if(M.fadeOut(),k&&k.posts&&k.posts.length){const S=$('[component="post"]:not([data-index=0]):not(.new), [component="topic/event"]');a(k,S,t,!0,N)}else h.update(),N()})},l.onTopicPageLoad=async function(t){b(t),R.wrapImagesInLinks(t),g(t),l.showBottomPostBar(),t.find('[component="post/content"] img:not(.not-responsive)').addClass("img-fluid"),l.addBlockquoteEllipses(t),K(t),await f()},l.addTopicEvents=async function(t){if(config.topicPostSort==="most_votes")return;const i=await Promise.all(t.map(p=>app.parseAndTranslate("partials/topic/event",{...p,privileges:ajaxify.data.privileges})));if(config.topicPostSort==="oldest_to_newest")$('[component="topic"]').append(i);else if(config.topicPostSort==="newest_to_oldest"){const p=$('[component="topic"] [component="post"][data-index="0"]');p.length?p.after(i.reverse()):$('[component="topic"]').prepend(i.reverse())}$('[component="topic/event"] .timeago').timeago()};async function f(){const t=ajaxify.data.necroThreshold*24*60*60*1e3;if(!t||config.topicPostSort!=="newest_to_oldest"&&config.topicPostSort!=="oldest_to_newest")return;const i=d.scrollTop(),p=$('[component="post"]').toArray();await Promise.all(p.map(async function(u){u=$(u);const x=u.prev('[component="post"]');if(u.is(":has(.necro-post)")||!x.length||config.topicPostSort==="newest_to_oldest"&&parseInt(x.attr("data-index"),10)===0)return;const M=u.attr("data-timestamp")-x.attr("data-timestamp");if(Math.abs(M)>=t){const k=["suffixAgo","prefixAgo","suffixFromNow","prefixFromNow"],N={};k.forEach(j=>{N[j]=$.timeago.settings.strings[j],$.timeago.settings.strings[j]=""});const S=(M>0?"[[topic:timeago-later,":"[[topic:timeago-earlier,")+$.timeago.inWords(M)+"]]";k.forEach(j=>{$.timeago.settings.strings[j]=N[j]});const B=await app.parseAndTranslate("partials/topic/necro-post",{text:S});B.attr("data-necro-post-index",x.attr("data-index")),B.insertBefore(u)}})),i>0&&d.scrollTop()<i&&d.scrollTop(i)}function g(t){ajaxify.data["signatures:hideDuplicates"]&&t.each((i,p)=>{const u=$(p).find('[component="post/signature"]'),x=u.attr("data-uid");l.signaturesShown[x]?u.addClass("hidden"):l.signaturesShown[x]=!0})}function I(t){t.each((i,p)=>{$(`[data-necro-post-index="${$(p).attr("data-index")}"]`).remove()})}function b(t){if(app.user.uid||!ajaxify.data.privateUploads)return;const i=document.createElement("a");i.className="login-required",i.href=config.relative_path+"/login",A.translate("[[topic:login-to-view]]",function(p){i.appendChild(document.createTextNode(p)),t.each(function(u,x){$(x).find('[component="post/content"] img').each(function(M,k){k=$(k),k.attr("src").startsWith(config.relative_path+config.upload_url)&&k.replaceWith(i.cloneNode(!0))})})})}l.onNewPostsAddedToDom=async function(t){await l.onTopicPageLoad(t),t.find(".timeago").timeago()},l.showBottomPostBar=function(){const t=y.get("post","index",0),i=$(".post-bar-placeholder"),p=$('[component="post"]');t.length&&p.length>1&&$(".post-bar").length<2&&i.length?($(".post-bar").clone().insertAfter(i),i.remove()):t.length&&p.length<2&&t.find(".post-bar").remove()};function K(t){t.each(function(){$(this).hasClass("deleted")&&w.toggle($(this).attr("data-pid"),!0)})}return l.addBlockquoteEllipses=function(t){t.find('[component="post/content"] blockquote').filter((u,x)=>!$(x).parent().is("blockquote")).find(">blockquote").each(function(){const u=$(this);u.find(":hidden:not(br)").length&&!u.find(".toggle").length&&u.append('<i class="d-inline-block fa fa-angle-down pointer toggle py-1 px-3 border text-bg-light"></i>')})},l}).apply(L,C),v!==void 0&&(W.exports=v)},60644(W,L,s){var C,v;C=[s(52473),s(68636),s(96352),s(25967)],v=(function(r,m,w,R){const h={};let y;h.init=function(T){y=T,A(),$(window).off("action:popstate",P).on("action:popstate",P)},h.onBackClicked=P;function A(){$('[component="category"]').on("click",'[component="topic/header"]',function(){const T=$(this).parents("[data-index]").attr("data-index"),l=$(window).scrollTop();$('[component="category/topic"]').each(function(d,E){if($(E).offset().top-l>0)return m.setItem("category:bookmark",$(E).attr("data-index")),m.setItem("category:bookmark:clicked",T),m.setItem("category:bookmark:offset",$(E).offset().top-l),!1})})}function P(T){const l=T&&ajaxify.data.template.unread;if(ajaxify.data.template.category||ajaxify.data.template.recent||ajaxify.data.template.popular||l){let d=m.getItem("category:bookmark"),E=m.getItem("category:bookmark:clicked");if(m.removeItem("category:bookmark"),m.removeItem("category:bookmark:clicked"),!utils.isNumber(d))return;if(d=Math.max(0,parseInt(d,10)||0),E=Math.max(0,parseInt(E,10)||0),config.usePagination){const D=Math.ceil((parseInt(d,10)+1)/config.topicsPerPage);parseInt(D,10)!==ajaxify.data.pagination.currentPage?R.loadPage(D,function(){h.scrollToTopic(d,E)}):h.scrollToTopic(d,E)}else{if(d===0){h.scrollToTopic(d,E);return}$('[component="category"]').empty(),y(Math.max(0,d-1)+1,function(){h.scrollToTopic(d,E)})}}}return h.highlightTopic=function(T){const l=r.get("category/topic","index",T);l.length&&!l.hasClass("highlight")&&(l.addClass("highlight"),setTimeout(function(){l.removeClass("highlight")},5e3))},h.scrollToTopic=function(T,l){if(!utils.isNumber(T))return;const d=r.get("category/topic","index",T);if(d.length){const E=m.getItem("category:bookmark:offset");m.removeItem("category:bookmark:offset"),$(window).scrollTop(d.offset().top-E),h.highlightTopic(l),w.update()}},h}).apply(L,C),v!==void 0&&(W.exports=v)},60984(W,L,s){var C,v;C=[s(52473),s(17459),s(60644),s(47536),s(49897),s(91749),s(33530),s(29930),s(89336),s(30076)],v=(function(r,m,w,R,h,y,A,P,T,l){const d={};d.init=function(e,o){E(o),$(".topic-main-buttons [title]").tooltip({container:"#content",animation:!1}),d.observeTopicLabels($('[component="topic/labels"]')),o.on("click",'[component="topic/delete"]',function(){return D("del","/state","delete"),!1}),o.on("click",'[component="topic/restore"]',function(){return D("put","/state","restore"),!1}),o.on("click",'[component="topic/purge"]',function(){return D("del","","purge"),!1}),o.on("click",'[component="topic/lock"]',function(){return D("put","/lock","lock"),!1}),o.on("click",'[component="topic/unlock"]',function(){return D("del","/lock","unlock"),!1}),o.on("click",'[component="topic/pin"]',function(){return D("put","/pin","pin"),!1}),o.on("click",'[component="topic/unpin"]',function(){return D("del","/pin","unpin"),!1}),o.on("click",'[component="topic/mark-unread"]',function(){D("del","/read",void 0,()=>{app.previousUrl&&!app.previousUrl.match("^/topic")?ajaxify.go(app.previousUrl,function(){w.onBackClicked(!0)}):ajaxify.data.category&&ajaxify.go("category/"+ajaxify.data.category.slug,w.onBackClicked),P.success("[[topic:mark-unread.success]]")})}),o.on("click",'[component="topic/mark-unread-for-all"]',function(){const n=$(this);D("put","/bump",void 0,()=>{P.success("[[topic:markAsUnreadForAll.success]]"),n.parents(".thread-tools.open").find(".dropdown-toggle").trigger("click")})}),o.on("click",'[component="topic/event/delete"]',function(){const n=$(this).attr("data-topic-event-id"),a=$(this).parents("[data-topic-event-id]");A.confirm("[[topic:delete-event-confirm]]",f=>{f&&h.del(`/topics/${e}/events/${n}`,{}).then(function(){const g=a.parents('[component="topic/event/items"]');if(a.remove(),g.length){const I=g.children().length,b=g.parents('[component="topic/event"]');I?b.find("[data-bs-toggle]").translateText(`[[topic:announcers-x, ${I}]]`):b.remove()}}).catch(P.error)})}),o.on("click",'[component="topic/move"]',function(){return s.e(28310).then(function(){var n=[s(28310)];(function(a){a.init([e],ajaxify.data.cid)}).apply(null,n)}).catch(s.oe),!1}),o.on("click",'[component="topic/crosspost"]',()=>{s.e(17325).then(function(){var n=[s(17325)];(a=>{a.init(e,ajaxify.data.cid)}).apply(null,n)}).catch(s.oe)}),o.on("click",'[component="topic/delete/posts"]',function(){s.e(36422).then(function(){var n=[s(36422)];(function(a){a.init()}).apply(null,n)}).catch(s.oe)}),o.on("click",'[component="topic/fork"]',function(){s.e(49771).then(function(){var n=[s(49771)];(function(a){a.init()}).apply(null,n)}).catch(s.oe)}),o.on("click",'[component="topic/merge"]',function(){s.e(2403).then(function(){var n=[s(2403)];(function(a){a.init(function(){a.addTopic(ajaxify.data.tid)})}).apply(null,n)}).catch(s.oe)}),o.on("click",'[component="topic/tag"]',function(){Promise.all([s.e(20056),s.e(63)]).then(function(){var n=[s(63)];(function(a){a.init([ajaxify.data],ajaxify.data.tagWhitelist)}).apply(null,n)}).catch(s.oe)}),o.on("click",'[component="topic/move-posts"]',function(){s.e(90677).then(function(){var n=[s(90677)];(function(a){a.init()}).apply(null,n)}).catch(s.oe)}),o.on("click",'[component="topic/following"]',function(){c("follow")}),o.on("click",'[component="topic/not-following"]',function(){c("follow",0)}),o.on("click",'[component="topic/ignoring"]',function(){c("ignore")});function c(n,a=1){return h[a?"put":"del"](`/topics/${e}/${n}`,{},()=>{let g="";n==="follow"?g=a?"[[topic:following-topic.message]]":"[[topic:not-following-topic.message]]":n==="ignore"&&(g=a?"[[topic:ignoring-topic.message]]":"[[topic:not-following-topic.message]]"),a||(n="unfollow"),U(n),P.alert({alert_id:"follow_thread",message:g,type:"success",timeout:5e3}),y.fire("action:topics.changeWatching",{tid:e,type:n})},()=>{P.alert({type:"danger",alert_id:"topic_follow",title:"[[global:please-log-in]]",message:"[[topic:login-to-subscribe]]",timeout:5e3})}),!1}},d.observeTopicLabels=function(e){const o=new MutationObserver(function(c){const n=c[0];if(n&&n.attributeName==="class"){const a=e.children().filter((f,g)=>!$(g).hasClass("hidden"));e.toggleClass("hidden",!a.length)}});e.children().each((c,n)=>{o.observe(n,{attributes:!0})})};function E(e){e&&e.on("show.bs.dropdown",".thread-tools",async function(){const o=$(this),c=o.find(".dropdown-menu"),{top:n}=this.getBoundingClientRect();if(o.toggleClass("dropup",n>window.innerHeight/2),c.attr("data-loaded"))return;c.html(l.generatePlaceholderWave([8,8,8]));const a=await socket.emit("topics.loadTopicTools",{tid:ajaxify.data.tid,cid:ajaxify.data.cid}).catch(P.error),f=await app.parseAndTranslate("partials/topic/topic-menu-list",a);$(c).attr("data-loaded","true").html(f),y.fire("action:topic.tools.load",{element:$(c)})})}function D(e,o,c,n){n||(n=function(){});const a=ajaxify.data.tid,f={},g=function(I){I&&h[e](`/topics/${a}${o}`,f).then(n).catch(P.error)};switch(c){case"delete":case"restore":case"purge":A.confirm(`[[topic:thread-tools.${c}-confirm]]`,g);break;case"pin":d.requestPinExpiry(f,g.bind(null,!0));break;default:g(!0);break}}d.requestPinExpiry=function(e,o){app.parseAndTranslate("modals/set-pin-expiry",{},function(c){const n=A.dialog({title:"[[topic:thread-tools.pin]]",message:c,onEscape:!0,buttons:{cancel:{label:"[[modules:bootbox.cancel]]",className:"btn-link"},save:{label:"[[global:save]]",className:"btn-primary",callback:function(){const a=n.get(0).querySelector("#expiry-date"),f=n.get(0).querySelector("#expiry-time");let g=a.value,I=f.value;if(g===""&&I==="")return o();g=g||new Date().toDateString(),I=I||new Date().toTimeString();const b=new Date(`${g} ${I}`);b.getTime()>Date.now()?(e.expiry=b.getTime(),o()):P.error("[[error:invalid-date]]")}}}})})},d.setLockedState=function(e){const o=r.get("topic");if(String(e.tid)!==o.attr("data-tid"))return;const c=e.isLocked&&!ajaxify.data.privileges.isAdminOrMod;r.get("topic/lock").toggleClass("hidden",e.isLocked).parent().attr("hidden",e.isLocked?"":null),r.get("topic/unlock").toggleClass("hidden",!e.isLocked).parent().attr("hidden",e.isLocked?null:"");const n=!!((e.isLocked||ajaxify.data.deleted)&&!ajaxify.data.privileges.isAdminOrMod);r.get("topic/reply/container").toggleClass("hidden",n),r.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!e.isLocked||ajaxify.data.deleted),o.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",n),o.find('[component="post/edit"], [component="post/delete"]').toggleClass("hidden",c),o.find('[component="post"][data-uid="'+app.user.uid+'"].deleted [component="post/tools"]').toggleClass("hidden",c),$('[component="topic/labels"] [component="topic/locked"]').toggleClass("hidden",!e.isLocked),$('[component="post/tools"] .dropdown-menu').html(""),ajaxify.data.locked=e.isLocked,R.addTopicEvents(e.events)},d.setDeleteState=function(e){const o=r.get("topic");if(String(e.tid)!==o.attr("data-tid"))return;r.get("topic/delete").toggleClass("hidden",e.isDelete).parent().attr("hidden",e.isDelete?"":null),r.get("topic/restore").toggleClass("hidden",!e.isDelete).parent().attr("hidden",e.isDelete?null:""),r.get("topic/purge").toggleClass("hidden",!e.isDelete).parent().attr("hidden",e.isDelete?null:""),r.get("topic/deleted/message").toggleClass("hidden",!e.isDelete),e.isDelete&&app.parseAndTranslate("partials/topic/deleted-message",{deleter:e.user,deleted:!0,deletedTimestampISO:utils.toISOString(Date.now())},function(n){r.get("topic/deleted/message").replaceWith(n),n.find(".timeago").timeago()});const c=e.isDelete&&!ajaxify.data.privileges.isAdminOrMod;r.get("topic/reply/container").toggleClass("hidden",c),r.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!ajaxify.data.locked||e.isDelete),o.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",c),o.toggleClass("deleted",e.isDelete),ajaxify.data.deleted=e.isDelete?1:0,R.addTopicEvents(e.events)},d.setPinnedState=function(e){const o=r.get("topic");if(String(e.tid)!==o.attr("data-tid"))return;r.get("topic/pin").toggleClass("hidden",e.pinned).parent().attr("hidden",e.pinned?"":null),r.get("topic/unpin").toggleClass("hidden",!e.pinned).parent().attr("hidden",e.pinned?null:"");const c=$('[component="topic/labels"] [component="topic/pinned"]');c.toggleClass("hidden",!e.pinned),e.pinned&&c.translateAttr("title",e.pinExpiry&&e.pinExpiryISO?"[[topic:pinned-with-expiry, "+e.pinExpiryISO+"]]":"[[topic:pinned]]"),ajaxify.data.pinned=e.pinned,R.addTopicEvents(e.events)};function U(e){const o={follow:"[[topic:watching]]",unfollow:"[[topic:not-watching]]",ignore:"[[topic:ignoring]]"};m.translate(o[e],function(n){const a=T.Tooltip.getInstance('[component="topic/watch"]');a&&a.setContent({".tooltip-inner":n})});let c=r.get("topic/following/menu");c.toggleClass("hidden",e!=="follow"),r.get("topic/following/check").toggleClass("fa-check",e==="follow"),c=r.get("topic/not-following/menu"),c.toggleClass("hidden",e!=="unfollow"),r.get("topic/not-following/check").toggleClass("fa-check",e==="unfollow"),c=r.get("topic/ignoring/menu"),c.toggleClass("hidden",e!=="ignore"),r.get("topic/ignoring/check").toggleClass("fa-check",e==="ignore")}return d}).apply(L,C),v!==void 0&&(W.exports=v)}}]);
