"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[25285,40755,69749],{43349(E,w,l){var p,u;p=[l(52473)],u=(function(k){const v={};return v.handleSort=function(f,x){const C=k.get("thread/sort");C.find("i").removeClass("fa-check");const c=utils.params().sort||config[f];C.find('a[data-sort="'+c+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a[data-sort]').on("click",'[component="thread/sort"] a[data-sort]',function(){const m=$(this).attr("data-sort"),e=utils.params();e.sort=m;const s=$.param(e);ajaxify.go(x+(s?"?"+s:""))})},v}).apply(w,p),u!==void 0&&(E.exports=u)},69749(E,w,l){var p,u;p=[l(17459),l(68636),l(91749),l(29930),l(89336),l(77918)],u=(function(k,v,f,x,C){const c={current:{}};c.saveToHistory=function(e){if(!e||e.length<2)return;let s=JSON.parse(localStorage.getItem("searchHistory")||"[]");s=s.filter(n=>n!==e),s.unshift(e),s=s.slice(0,8),v.setItem("searchHistory",JSON.stringify(s))},c.getHistory=function(){try{return JSON.parse(localStorage.getItem("searchHistory")||"[]")}catch(e){return console.error("Error reading search history:",e),[]}},c.clearHistory=function(){localStorage.removeItem("searchHistory")},c.displayHistory=function(e,s){const n=c.getHistory();if(!n||n.length===0){e.addClass("hidden").empty();return}let t='<div class="search-history-container">';t+='<div class="search-history-items">',n.forEach(function(i){t+='<div class="search-history-item" data-term="'+utils.escapeHTML(i)+'">',t+='<svg class="search-history-icon" width ="16" height="16" viewBox="0 0 24 24" fill="none" stroke = "currentColor" stroke-width="2">',t+='<circle cx="12" cy="12" r="10"></circle>',t+='<polyline points="12 6 12 12 16 14"></polyline>',t+="</svg>",t+='<span class="search-history-text">'+utils.escapeHTML(i)+"</span>",t+="</div>"}),t+="</div>",t+='<div class="search-history-clear">',t+='<button class="clear-history-btn">Clear search history</button>',t+="</div>",t+="</div>",e.removeClass("hidden").html(t),e.find(".search-history-item").on("click",function(){const i=$(this).data("term");s.val(i),s.closest("form").trigger("submit")}),e.find(".clear-history-btn").on("click",function(i){i.preventDefault(),i.stopPropagation(),c.clearHistory(),e.addClass("hidden"),s.trigger("focus")})},c.init=function(e){if(!config.searchEnabled)return;e=e||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((n,t)=>{b($(t),e)}),$(document).on("focus",'[component="search/fields"] input[name="query"]',function(){var n=$(this),t=n.closest('[component="search/fields"]').find("#quick-search-container"),i=n.val();(!i||i.length===0)&&(c.displayHistory(t,n),t.css({display:"block",visibility:"visible"}))})},c.showHistoryDropdown=function(e,s,n){c.displayHistory(e,s)};function b(e,s){const n=e.find('[component="search/button"]'),t=e.find('[component="search/fields"]'),i=t.find('input[name="query"]'),o=t.find("#quick-search-container"),h=t.hasClass("hidden"),a=/^(@|acct:)?[\w-]+@.+$/;h&&t.off("focusout").on("focusout",function(){setTimeout(function(){t.find(":focus").length||(t.addClass("hidden"),n.removeClass("hidden"))},200)}),i.off("focus");const S={inputEl:i,resultEl:o};c.enableQuickSearch({searchOptions:s,searchElements:S}),n.off("click").on("click",function(y){return!config.loggedIn&&!app.user.privileges["search:content"]?(x.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(y.stopPropagation(),c.showAndFocusInput(e),!1)}),e.off("submit").on("submit",function(){const y=$(this).find('input[name="query"]'),g=c.getSearchPreferences();return g.term=y.val(),g.in=s.in,c.saveToHistory(g.term),a.test(g.term)&&(g.in="users"),f.fire("action:search.submit",{searchOptions:g,searchElements:S}),c.query(g,function(){y.val(""),i.trigger("blur")}),!1})}c.enableQuickSearch=function(e){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const s=Object.assign({in:config.searchDefaultInQuick||"titles"},e.searchOptions),n=e.searchElements.resultEl,t=e.searchElements.inputEl;let i=t.val();const o=n.find(".filter-category");function h(){ajaxify.data.template.category&&ajaxify.data.cid&&k.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(r){const d=$("<div></div>").html(r).text();o.find(".name").text(d)}),o.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function a(){e.searchOptions=Object.assign({},s),e.searchOptions.term=t.val(),h(),ajaxify.data.template.category&&ajaxify.data.cid&&o.find('input[type="checkbox"]').is(":checked")&&(e.searchOptions.categories=[ajaxify.data.cid],e.searchOptions.searchChildren=!0),e.hideDuringSearch||(n.removeClass("hidden").find(".quick-search-results-container").html(""),n.find(".loading-indicator").removeClass("hidden")),f.fire("action:search.quick.start",e),e.searchOptions.searchOnly=1,c.api(e.searchOptions,function(r){if(n.find(".loading-indicator").addClass("hidden"),e.searchOptions.in==="categories"){if(!r.categories||e.hideOnNoMatches&&!r.categories.length)return n.addClass("hidden").find(".quick-search-results-container").html("");r.dropdown={maxWidth:"400px",maxHeight:"500px",...e.dropdown},app.parseAndTranslate("partials/quick-category-search-results",r,d=>{d.length&&d.find(".timeago").timeago(),n.toggleClass("hidden",!d.length||!t.is(":focus")).find(".quick-search-results-container").html(d.length?d:""),f.fire("action:search.quick.complete",{data:r,options:e})})}else{if(!r.posts||e.hideOnNoMatches&&!r.posts.length)return n.addClass("hidden").find(".quick-search-results-container").html("");r.posts.forEach(function(d){const O=$("<div>"+d.content+"</div>").text(),q=t.val().toLowerCase().replace(/^in:topic-\d+/,""),I=Math.max(0,O.toLowerCase().indexOf(q)-40);d.snippet=utils.escapeHTML((I>0?"...":"")+O.slice(I,I+80)+(O.length-I>80?"...":""))}),r.dropdown={maxWidth:"400px",maxHeight:"500px",...e.dropdown},app.parseAndTranslate("partials/quick-search-results",r,function(d){d.length&&d.find(".timeago").timeago(),n.toggleClass("hidden",!d.length||!t.is(":focus")).find(".quick-search-results-container").html(d.length?d:"");const O=n.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");c.highlightMatches(e.searchOptions.term,O),f.fire("action:search.quick.complete",{data:r,options:e})})}})}n.find('.filter-category input[type="checkbox"]').on("change",function(){t.focus(),a()}),t.off("keyup").on("keyup",utils.debounce(function(){if(t.val().length<3){n.addClass("hidden"),i=t.val();return}if(t.val()!==i){if(i=t.val(),!t.is(":focus"))return n.addClass("hidden");a()}},500)),n.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){n.addClass("hidden")})});const S=t.parent(),y=n.parent();S.on("focusout",g),y.on("focusout",g);function g(){setTimeout(function(){!S.find(":focus").length&&!y.find(":focus").length&&!n.hasClass("hidden")&&n.addClass("hidden")},200)}let H=!1;f.on("action:ajaxify.end",function(){ajaxify.isCold()||(H=!0),n.addClass("hidden")}),t.on("focus",function(){console.log("focus on fired event");const r=t.val();if(i=r,!r||r.length===0){c.showHistoryDropdown(n,t,s);return}r&&n.find("#quick-search-results").children().length&&(h(),H?(a(),H=!1):n.removeClass("hidden"),t[0].setSelectionRange(r.startsWith("in:topic")?r.indexOf(" ")+1:0,r.length))}),t.off("refresh").on("refresh",function(){a()})},c.showAndFocusInput=function(e){const s=e.parents(".dropdown-menu");if(s.length){const n=s.siblings("[data-bs-toggle]"),t=C.Dropdown.getOrCreateInstance(n[0]);t&&t.show()}else e.find('[component="search/fields"]').removeClass("hidden"),e.find('[component="search/button"]').addClass("hidden"),e.find('[component="search/fields"] input[name="query"]').trigger("focus")},c.query=function(e,s){s=s||function(){},ajaxify.go("search?"+m(e),s)},c.api=function(e,s){const n=config.relative_path+"/api/search?"+m(e);e.hasOwnProperty("searchOnly")&&delete e.searchOnly;const t=config.relative_path+"/search?"+m(e);$.get(n,function(i){i.url=t,s(i)})};function m(e){const s=e.in||"titles",n=e.term.replace(/^[ ?#]*/,""),t={...e,term:n,in:s};return f.fire("action:search.createQueryString",{query:t,data:e}),$.param(t)}return c.getSearchPreferences=function(){try{return JSON.parse(v.getItem("search-preferences")||"{}")}catch(e){return console.error(e),{}}},c.highlightMatches=function(e,s){if(!e||!s.length)return;e=utils.escapeHTML(e.replace(/^"/,"").replace(/"$/,"").trim());const n=e.split(" ").filter(i=>i.length>1).map(function(i){return utils.escapeRegexChars(i)}).join("|"),t=new RegExp("("+n+")","gi");s.each(function(){const i=$(this),o=[];i.find("*").each(function(){$(this).after("<!-- "+o.length+" -->"),o.push($("<div></div>").append($(this)))}),i.html(i.html().replace(t,function(h,a){return'<strong class="search-match fw-bold text-decoration-underline">'+a+"</strong>"})),o.forEach(function(h,a){i.html(i.html().replace("<!-- "+a+" -->",function(){return h.html()}))})}),$(".search-results .content").find("img:not(.not-responsive)").addClass("img-fluid")},c}).apply(w,p),u!==void 0&&(E.exports=u)},96147(E,w,l){var p,u;p=[l(47682),l(69749),l(43349),l(91749),l(29930),l(49897),l(33530)],u=(function(k,v,f,x,C,c,b){const m={};m.init=function(){app.enterRoom("world"),k.init("world"),f.handleSort("categoryTopicSort","world"),e(-1),s(),n(),v.enableQuickSearch({searchElements:{inputEl:$('[component="category-search"]'),resultEl:$(".world .quick-search-container")},searchOptions:{in:"categories"},dropdown:{maxWidth:"400px",maxHeight:"350px"},hideOnNoMatches:!1}),x.fire("action:topics.loaded",{topics:ajaxify.data.topics}),x.fire("action:category.loaded",{cid:ajaxify.data.cid})};function e(t){$('[component="category/watching"], [component="category/tracking"], [component="category/ignoring"], [component="category/notwatching"]').on("click",function(){const o=$(this).attr("data-state");c.put(`/categories/${t}/watch`,{state:o},h=>{if(h)return C.error(h);$('[component="category/watching/menu"]').toggleClass("hidden",o!=="watching"),$('[component="category/watching/check"]').toggleClass("fa-check",o==="watching"),$('[component="category/tracking/menu"]').toggleClass("hidden",o!=="tracking"),$('[component="category/tracking/check"]').toggleClass("fa-check",o==="tracking"),$('[component="category/notwatching/menu"]').toggleClass("hidden",o!=="notwatching"),$('[component="category/notwatching/check"]').toggleClass("fa-check",o==="notwatching"),$('[component="category/ignoring/menu"]').toggleClass("hidden",o!=="ignoring"),$('[component="category/ignoring/check"]').toggleClass("fa-check",o==="ignoring"),C.success("[[category:"+o+".message]]")})})}function s(){const t=document.getElementById("world-help");if(!t)return;const i=['<p class="lead">[[world:help.intro]]</p>',"<p>[[world:help.fediverse]]</p>","<p>[[world:help.build]]</p>","<p>[[world:help.federating]]</p>","<p>[[world:help.next-generation]]</p>"];t.addEventListener("click",()=>{b.dialog({title:"[[world:help.title]]",message:i.join(`
`),size:"large"})})}function n(){const t=document.getElementById("show-categories"),i=document.getElementById("hide-categories"),o=document.querySelector(".categories-list");if(![t,i,o].every(Boolean))return;const h=()=>{t.classList.toggle("hidden",a),i.classList.toggle("hidden",!a),o.classList.toggle("hidden",!a),localStorage.setItem("world:show-categories",a)};let a=localStorage.getItem("world:show-categories");console.log("got value",a),a=a?a==="true":!0,h(),t.addEventListener("click",()=>{a=!0,h()}),i.addEventListener("click",()=>{a=!1,h()})}return m}).apply(w,p),u!==void 0&&(E.exports=u)}}]);
