"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1091,13201,15794,25432,33069,34271,34590,41427,49897,61861,68326,69749,87212,87549,92717,98813,99127],{10870(k,C,l){var g,d;g=[l(33530),l(17459),l(68636),l(29930),l(91749)],d=(function(h,p,s,u,y){const o={};let v,w;o.show=function(){y.one("action:ajaxify.end",()=>{a(),n(),o.showEmailConfirmWarning()})},o.showEmailConfirmWarning=function(i){if(!config.emailPrompt||!app.user.uid||parseInt(s.getItem("email-confirm-dismiss"),10)===1)return;const e={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{s.setItem("email-confirm-dismiss",1)}};!app.user.email&&!app.user.isEmailConfirmSent?(e.message="[[error:no-email-to-confirm]]",e.clickfn=function(){u.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},u.alert(e)):!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(e.message=i||"[[error:email-not-confirmed]]",e.clickfn=function(){u.remove("email_confirm"),ajaxify.go("/me/edit/email")},u.alert(e)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(e.message="[[error:email-not-confirmed-email-sent]]",u.alert(e))};function n(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||s.getItem("cookieconsent")==="1"||(config.cookies.message=p.unescape(config.cookies.message),config.cookies.dismiss=p.unescape(config.cookies.dismiss),config.cookies.link=p.unescape(config.cookies.link),config.cookies.link_url=p.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(i){$(document.body).append(i),$(document.body).addClass("cookie-consent-open");const e=$(".cookie-consent");e.find("button").on("click",function(){s.setItem("cookieconsent","1"),e.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function a(){const i=utils.params({full:!0});v=i.has("loggedin"),w=i.get("register"),v&&(u.alert({type:"success",title:"[[global:welcome-back]] "+app.user.username+"!",message:"[[global:you-have-successfully-logged-in]]",timeout:5e3}),i.delete("loggedin")),w&&(h.alert({message:utils.escapeHTML(decodeURIComponent(w))}),i.delete("register")),i.has("lang")&&i.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${i.get("lang")}", but that is already the forum default language.`),i.delete("lang"));const e=i.toString();ajaxify.updateHistory(ajaxify.currentPage+(e?`?${e}`:"")+document.location.hash,!0)}return o.showInvalidSession=function(){h.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},o.showSessionMismatch=function(){h.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},o}).apply(C,g),d!==void 0&&(k.exports=d)},11599(k,C,l){var g,d;g=[l(52473),l(91749),l(49897)],d=(function(h,p,s){const u={};u.prepareDOM=function(){const n=$('[component="chat/dropdown"]');n.on("show.bs.dropdown",a=>{w("loadChatsDropdown",$(a.target).parent().find('[component="chat/list"]'))}),n.each((a,i)=>{const e=$(i).parent().find(".dropdown-menu");e.hasClass("show")&&w("loadChatsDropdown",e.find('[component="chat/list"]'))}),socket.removeListener("event:chats.receive",y),socket.on("event:chats.receive",y),socket.removeListener("event:chats.typing",o),socket.on("event:chats.typing",o),socket.removeListener("event:chats.roomRename",v),socket.on("event:chats.roomRename",v),socket.on("event:unread.updateChatCount",async function(a){if(a){const[f,I]=await app.require(["chat","forum/chats"]);if(f.isFromBlockedUser(a.fromUid)||f.isLookingAtRoom(a.roomId)||app.user.uid===parseInt(a.fromUid,10))return;I.markChatPageElUnread(a),I.updateTeaser(a.roomId,a.teaser)}let{count:i}=await s.get("/chats/unread");const e=h.get("chat/icon");i=Math.max(0,i),e.toggleClass("fa-comment",i>0).toggleClass("fa-comment-o",i<=0);const c=i>99?"99+":i;h.get("chat/icon").toggleClass("unread-count",i>0).attr("data-content",c),h.get("chat/count").toggleClass("hidden",i<=0).text(c),p.fire("action:chat.updateCount",{count:i})})};function y(n){w("onChatMessageReceived",n)}function o(n){w("onUserTyping",n)}function v(n){w("onRoomRename",n)}async function w(n,a){(await app.require("chat"))[n](a)}return u}).apply(C,g),d!==void 0&&(k.exports=d)},14063(k,C,l){k=l.nmd(k);var g,d;g=[l(17459),l(91749)],d=(function(h,p){const s={};let u=!1;s.init=function(){if(s.taskbar=$('[component="taskbar"]'),s.tasklist=s.taskbar.find("ul"),!s.taskbar.length||!s.tasklist.length){u=!0;return}s.taskbar.on("click","li",async function(){const n=$(this),a=n.attr("data-module"),i=n.attr("data-uuid"),e=await app.require(a);return n.hasClass("active")?e.minimize(i):(o(),e.load(i),s.toggleNew(i,!1),s.tasklist.removeClass("active"),n.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){s.closeAll()})},s.close=async function(n,a){if(u)return;if(s.tasklist.find('[data-module="'+k+'"][data-uuid="'+a+'"]').length){const e=await app.require(n);e&&typeof e.close=="function"&&e.close(a)}},s.closeAll=function(n){if(u)return;let a="[data-uuid]";n&&(a='[data-module="'+n+'"]'+a),s.tasklist.find(a).each(function(i,e){s.close(n||e.getAttribute("data-module"),e.getAttribute("data-uuid"))})},s.discard=function(n,a){if(u)return;s.tasklist.find('[data-module="'+n+'"][data-uuid="'+a+'"]').remove(),y()},s.push=function(n,a,i,e){if(e=e||function(){},u)return e();const c=s.tasklist.find('li[data-uuid="'+a+'"]'),f={module:n,uuid:a,options:i,element:c};p.fire("filter:taskbar.push",f),!c.length&&f.module?v(f,e):e(c)},s.get=function(n){return u?[]:$('[data-module="'+n+'"]').map(function(i,e){return $(e).data()})},s.minimize=function(n,a){if(u)return;s.tasklist.find('[data-module="'+n+'"][data-uuid="'+a+'"]').toggleClass("active",!1)},s.toggleNew=function(n,a,i){if(u)return;s.tasklist.find('[data-uuid="'+n+'"]').toggleClass("new",a),i||p.fire("action:taskbar.toggleNew",n)},s.updateActive=function(n){if(u)return;const a=s.tasklist.find("li");a.removeClass("active"),a.filter('[data-uuid="'+n+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+n+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},s.isActive=function(n){return u?!1:s.tasklist.find('li[data-uuid="'+n+'"]').hasClass("active")};function y(){if(u)return;s.tasklist.find("li").length>0?s.taskbar.attr("data-active","1"):s.taskbar.removeAttr("data-active")}function o(){u||s.tasklist.find(".active").removeClass("active")}function v(n,a){if(u)return a();h.translate(n.options.title,function(i){const e=$("<div></div>").text(i||"NodeBB Task").html(),c=$("<li></li>").addClass(n.options.className).html('<a href="#"'+(n.options.image?` style="background-image: url('`+n.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(n.options.icon?'<i class="fa '+n.options.icon+'"></i> ':"")+'<span aria-label="'+e+'" component="taskbar/title">'+e+"</span></a>").attr({title:e,"data-module":n.module,"data-uuid":n.uuid}).addClass(n.options.state!==void 0?n.options.state:"active");(!n.options.state||n.options.state==="active")&&o(),s.tasklist.append(c),y(),n.element=c,c.data(n),p.fire("action:taskbar.pushed",n),a(c)})}const w=function(n,a,i){switch(a){case"title":n.find('[component="taskbar/title"]').text(i);break;case"icon":n.find("i").attr("class","fa fa-"+i);break;case"image":n.find("a").css("background-image",i?'url("'+i.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":n.find("a").css("background-color",i);break;case"color":n.find("a").css("color",i);break}};return s.update=function(n,a,i){if(u)return;const e=s.tasklist.find('[data-module="'+n+'"][data-uuid="'+a+'"]');if(!e.length)return;const c=e.data();Object.keys(i).forEach(function(f){c[f]=i[f],w(e,f,i[f])}),e.data(c)},s}).apply(C,g),d!==void 0&&(k.exports=d)},19046(k,C,l){var g,d;g=[l(91749)],d=(function(h){const p={},s={ignoring:1,notwatching:2,watching:3};p.initUnreadTopics=function(){const o=app.user.unreadData;function v(a){if(a&&a.posts&&a.posts.length&&o){const i=a.posts[0];if(parseInt(i.uid,10)===parseInt(app.user.uid,10)||!i.topic.isFollowing&&i.categoryWatchState!==s.watching)return;const e=i.topic.tid;(!o[""][e]||!o.new[e]||!o.watched[e]||!o.unreplied[e])&&n(e),o[""][e]||(w(""),o[""][e]=!0),i.isMain&&parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!o.new[e]&&(w("new"),o.new[e]=!0),parseInt(i.topic.postcount,10)<=1&&!o.unreplied[e]&&(w("unreplied"),o.unreplied[e]=!0),i.topic.isFollowing&&!o.watched[e]&&(w("watched"),o.watched[e]=!0)}}function w(a){const i="/unread"+(a?"?filter="+a:""),e=1+parseInt($('a[href="'+config.relative_path+i+'"].navigation-link i').attr("data-content"),10);y(i,e)}function n(a){$('[data-tid="'+a+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(a){delete o[a][ajaxify.data.tid]})}),socket.removeListener("event:new_post",v),socket.on("event:new_post",v),socket.removeListener("event:unread.updateCount",u),socket.on("event:unread.updateCount",u)};function u(o){y("/unread",o.unreadTopicCount),y("/unread?filter=new",o.unreadNewTopicCount),y("/unread?filter=watched",o.unreadWatchedTopicCount),y("/unread?filter=unreplied",o.unreadUnrepliedTopicCount)}function y(o,v){if(!utils.isNumber(v))return;v=Math.max(0,v);const w=v>99?"99+":v,n=$('a[href="'+config.relative_path+o+'"].navigation-link');n.find("i").toggleClass("unread-count",v>0).attr("data-content",w),n.find('[component="navigation/count"]').toggleClass("hidden",v<=0).text(v),n.length&&($('#mobile-menu [data-unread-url="'+o+'"]').attr("data-content",w),$('[component="unread/count"][data-unread-url="'+o+'"]').toggleClass("hidden",v<=0).text(w)),h.fire("action:unread.updateCount",{url:o,count:v})}return p.updateUnreadTopicCount=y,p}).apply(C,g),d!==void 0&&(k.exports=d)},25967(k,C,l){var g,d;g=[l(33530)],d=(function(h){const p={};return p.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return h.prompt("[[global:enter-page-number]]",function(s){p.loadPage(s)}),!1})},p.loadPage=function(s,u){if(u=u||function(){},s=parseInt(s,10),!utils.isNumber(s)||s<1||s>ajaxify.data.pagination.pageCount)return;const y=utils.params();y.page=s;const o=window.location.pathname+"?"+$.param(y);ajaxify.go(o,u)},p.nextPage=function(s){p.loadPage(ajaxify.data.pagination.currentPage+1,s)},p.previousPage=function(s){p.loadPage(ajaxify.data.pagination.currentPage-1,s)},p}).apply(C,g),d!==void 0&&(k.exports=d)},29869(k){k.exports=function(C,l,g){l.setGlobal("true",!0),l.setGlobal("false",!1);const d=1440*60*1e3,h={displayMenuItem:s,buildMetaTag:u,buildLinkTag:y,stringify:o,escape:v,stripTags:w,buildCategoryIcon:n,buildCategoryLabel:a,generateCategoryBackground:i,generateChildrenCategories:e,generateTopicClass:c,membershipBtn:f,spawnPrivilegeStates:I,localeToHTML:D,renderTopicImage:_,renderDigestAvatar:E,userAgentIcons:T,buildAvatar:H,increment:b,lessthan:A,greaterthan:R,generateWroteReplied:F,generateRepliedTo:N,generateWrote:j,encodeURIComponent:K,isoTimeToLocaleString:q,shouldHideReplyContainer:z,humanReadableNumber:Y,formattedNumber:J,isNumber:G,txEscape:Q,uploadBasename:V,generatePlaceholderWave:X,register:Z,__escape:p};function p(t){return t}function s(t,r){const m=t.navigation[r];return!(!m||m.route.match("/users")&&t.user&&!t.user.privileges["view:users"]||m.route.match("/tags")&&t.user&&!t.user.privileges["view:tags"]||m.route.match("/groups")&&t.user&&!t.user.privileges["view:groups"])}function u(t){const r=t.name?'name="'+t.name+'" ':"",m=t.property?'property="'+t.property+'" ':"",x=t.content?'content="'+t.content.replace(/\n/g," ")+'" ':"";return"<meta "+r+m+x+`/>
	`}function y(t){const r=["link","rel","as","type","href","hreflang","sizes","title","crossorigin"],[m,x,M,S,P,W,L,U,B]=r.map(O=>t[O]?`${O}="${t[O]}" `:"");return"<link "+m+x+M+S+L+U+P+W+B+`/>
	`}function o(t){return JSON.stringify(t).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function v(t){return C.escapeHTML(t)}function w(t){return C.stripHTMLTags(t)}function n(t,r,m){return t?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${m}" style="${i(t)} width:${r}; height: ${r}; font-size: ${parseInt(r,10)/2}px;">${t.icon?`<i class="fa fa-fw ${t.icon}"></i>`:""}</span>`:""}function a(t,r="a",m=""){if(!t)return"";const x=r==="a"?`href="${g}/category/${t.slug}"`:"";return`<${r} component="topic/category" ${x} class="badge px-1 text-truncate text-decoration-none ${m}" style="color: ${t.color};background-color: ${t.bgColor};border-color: ${t.bgColor}!important; max-width: 70vw;">
			${t.icon&&t.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${t.icon}"></i>`:""}
			${t.name}
		</${r}>`}function i(t){if(!t)return"";const r=[];return t.bgColor&&(r.push("background-color: "+t.bgColor),r.push(`border-color: ${t.bgColor}!important`)),t.color&&r.push("color: "+t.color),t.backgroundImage&&(r.push("background-image: url("+t.backgroundImage+")"),t.imageClass&&r.push("background-size: "+t.imageClass)),r.join("; ")+";"}function e(t){let r="";return!t||!t.children||!t.children.length||(t.children.forEach(function(m){if(m&&!m.isSection){const x=m.link?m.link:g+"/category/"+m.slug;r+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+i(m)+'"><i class="fa fa-fw '+m.icon+'"></i></div><a href="'+x+'"><small>'+m.name+"</small></a></span>"}}),r=r&&'<span class="category-children">'+r+"</span>"),r}function c(t){return["locked","pinned","deleted","unread","scheduled"].filter(m=>!!t[m]).join(" ")}function f(t,r=""){return t.isMember&&t.name!=="administrators"?`<button class="btn btn-danger ${r}" data-action="leave" data-group="${t.displayName}" ${t.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:t.isPending&&t.name!=="administrators"?`<button class="btn btn-warning disabled ${r}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:t.isInvited?`<button class="btn btn-warning" data-action="rejectInvite" data-group="${t.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${t.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!t.disableJoinRequests&&t.name!=="administrators"?`<button class="btn btn-success ${r}" data-action="join" data-group="${t.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function I(t,r,m,x){const M=[];for(const[S,P]of Object.entries(m))M.push({name:S,state:P,type:x[S]});return M.map(function(S){const P=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],W=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],L=["groups:moderate"];let U=["groups:view:users","groups:find","groups:read","groups:topics:read","groups:topics:create","groups:topics:reply","groups:topics:tag","groups:posts:edit","groups:posts:history","groups:posts:delete","groups:posts:upvote","groups:posts:downvote","groups:topics:delete"];t===-1&&(U=U.slice(3));const B=r==="guests"&&(P.includes(S.name)||S.name.startsWith("groups:admin:"))||r==="spiders"&&!W.includes(S.name)||r==="fediverse"&&!U.includes(S.name)||r==="Global Moderators"&&L.includes(S.name);return`
				<td data-privilege="${S.name}" data-value="${S.state}" data-type="${S.type}">
					<div class="form-check text-center">
						<input class="form-check-input float-none${B?' d-none"':""}" autocomplete="off" type="checkbox"${S.state?" checked":""}${B?' disabled="disabled" aria-diabled="true"':""} />
					</div>
				</td>
			`}).join("")}function D(t,r){return t=t||r||"en-GB",t.replace("_","-")}function _(t){return t.thumb?'<img src="'+t.thumb+'" class="img-circle user-img" title="'+t.user.displayname+'" />':'<img component="user/picture" data-uid="'+t.user.uid+'" src="'+t.user.picture+'" class="user-img" title="'+t.user.displayname+'" />'}function E(t){return t.teaser?t.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.teaser.user.picture+'" title="'+t.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.teaser.user["icon:text"]+"</div>":t.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+t.user.picture+'" title="'+t.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+t.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+t.user["icon:text"]+"</div>"}function T(t){let r="";switch(t.platform){case"Linux":r+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":r+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":r+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":r+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":r+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":r+='<i class="fa fa-fw fa-mobile"></i>';break;default:r+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(t.browser){case"Chrome":r+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":r+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":r+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":r+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":r+='<i class="fa fa-fw fa-edge"></i>';break;default:r+='<i class="fa fa-fw fa-question-circle"></i>';break}return r}function H(t,r,m,x,M){t||(t=this),x=x||"";const S=new Map([["title",t.displayname],["data-uid",t.uid],["class",`avatar ${x}${m?" avatar-rounded":""}`]]),P=[`--avatar-size: ${r};`],W=U=>Array.from(U).reduce((B,[O,ee])=>(B+=` ${O}="${ee}"`,B),"");let L="";return t.picture&&(L+=`<img${W(S)} alt="${t.displayname}" loading="lazy" component="${M||"avatar/picture"}" src="${t.picture}" style="${P.join(" ")}" onError="this.remove()" itemprop="image" />`),L+=`<span${W(S)} component="${M||"avatar/icon"}" style="${P.join(" ")} background-color: ${t["icon:bgColor"]}">${t["icon:text"]}</span>`,L}function b(t,r){return String(t+parseInt(r,10))}function A(t,r){return parseInt(t,10)<parseInt(r,10)}function R(t,r){return parseInt(t,10)>parseInt(r,10)}function F(t,r){return t.toPid?N(t,r):j(t,r)}function N(t,r){const m=t.parent&&t.parent.displayname?t.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${t.timestamp<Date.now()-r*d?"on":"ago"}, ${t.toPid}, ${g}/post/${encodeURIComponent(t.toPid)}, ${m}, ${g}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function j(t,r){return`[[topic:wrote-${t.timestamp<Date.now()-r*d?"on":"ago"}, ${g}/post/${encodeURIComponent(t.pid)}, ${t.timestampISO}]]`}function K(t){return encodeURIComponent(t)}function q(t,r="en-GB"){return new Date(t).toLocaleString([r],{dateStyle:"short",timeStyle:"short"}).replace(/,/g,"&#44;")}function z(t){return!!(t.replies.count<=0||t.replies.hasSingleImmediateReply)}function Y(t,r=1){return C.makeNumberHumanReadable(t,r)}function J(t){return C.addCommas(t)}function G(t){return C.isNumber(t)}function Q(t){return String(t).replace(/%/g,"&#37;").replace(/,/g,"&#44;")}function V(t,r="/"){const m=/^\d+-/,x=t.substr(t.lastIndexOf(r)+1);return m.test(x)?x.slice(14):x}function X(t){return t.map(m=>m==="divider"?'<li class="dropdown-divider"></li>':`
			<li class="dropdown-item placeholder-wave">
				<div class="placeholder" style="width: 20px;"></div>
				<div class="placeholder col-${m}"></div>
			</li>`).join("")}function Z(){Object.keys(h).forEach(function(t){l.registerHelper(t,h[t])})}return h}},30076(k,C,l){var g,d;const h=l(29869);g=[l(77918),l(81335)],d=(function(p,s){return h(p,s,config.relative_path)}).apply(C,g),d!==void 0&&(k.exports=d)},49897(k,C,l){l.r(C),l.d(C,{del:()=>i,get:()=>o,head:()=>v,patch:()=>n,post:()=>w,put:()=>a});var g=l(91749),d=l.n(g),h=l(33530),p=l.n(h);const s=config.relative_path+"/api/v3";async function u(e,c){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:s+e.url,typeof c=="function"){y(e).then(f=>c(null,f),f=>c(f));return}try{return await y(e)}catch(f){if(f.message==="A valid login session was not found. Please log in and try again."){const{url:I}=await(0,g.fire)("filter:admin.reauth",{url:"login"});return(0,h.confirm)("[[error:api.reauth-required]]",D=>{D&&ajaxify.go(I)})}throw f}}async function y(e){const{url:c}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,g.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const f=await fetch(c,e),{headers:I}=f;if(I.get("x-redirect"))return y({url:I.get("x-redirect"),...e});const D=I.get("content-type"),_=D&&D.startsWith("application/json");let E;if(e.method!=="HEAD"&&(_?E=await f.json():E=await f.text()),!f.ok)throw E?new Error(_?E.status.message:E):new Error(f.statusText);return _&&E&&E.hasOwnProperty("status")&&E.hasOwnProperty("response")?E.response:E}function o(e,c,f){return u({url:e+(c&&Object.keys(c).length?"?"+$.param(c):"")},f)}function v(e,c,f){return u({url:e+(c&&Object.keys(c).length?"?"+$.param(c):""),method:"HEAD"},f)}function w(e,c,f){return u({url:e,method:"POST",data:c,headers:{"x-csrf-token":config.csrf_token}},f)}function n(e,c,f){return u({url:e,method:"PATCH",data:c,headers:{"x-csrf-token":config.csrf_token}},f)}function a(e,c,f){return u({url:e,method:"PUT",data:c,headers:{"x-csrf-token":config.csrf_token}},f)}function i(e,c,f){return u({url:e,method:"DELETE",data:c,headers:{"x-csrf-token":config.csrf_token}},f)}},68636(k,C,l){var g;g=(function(){function d(){this._store={},this._keys=[]}d.prototype.isMock=!0,d.prototype.setItem=function(s,u){s=String(s),this._keys.indexOf(s)===-1&&this._keys.push(s),this._store[s]=u},d.prototype.getItem=function(s){return s=String(s),this._keys.indexOf(s)===-1?null:this._store[s]},d.prototype.removeItem=function(s){s=String(s),this._keys=this._keys.filter(function(u){return u!==s}),this._store[s]=null},d.prototype.clear=function(){this._keys=[],this._store={}},d.prototype.key=function(s){return s=parseInt(s,10)||0,this._keys[s]},Object.defineProperty&&Object.defineProperty(d.prototype,"length",{get:function(){return this._keys.length}});let h;const p=Date.now().toString();try{if(h=window.localStorage,h.setItem(p,p),h.getItem(p)!==p)throw Error("localStorage behaved unexpectedly");return h.removeItem(p),h}catch(s){console.warn(s),console.warn("localStorage failed, falling back on sessionStorage");try{if(h=window.sessionStorage,h.setItem(p,p),h.getItem(p)!==p)throw Error("sessionStorage behaved unexpectedly");return h.removeItem(p),h}catch(u){return console.warn(u),console.warn("sessionStorage failed, falling back on memory storage"),new d}}}).call(C,l,C,k),g!==void 0&&(k.exports=g)},69749(k,C,l){var g,d;g=[l(17459),l(68636),l(91749),l(29930),l(89336),l(77918)],d=(function(h,p,s,u,y){const o={current:{}};o.saveToHistory=function(n){if(!n||n.length<2)return;let a=JSON.parse(localStorage.getItem("searchHistory")||"[]");a=a.filter(i=>i!==n),a.unshift(n),a=a.slice(0,8),p.setItem("searchHistory",JSON.stringify(a))},o.getHistory=function(){try{return JSON.parse(localStorage.getItem("searchHistory")||"[]")}catch(n){return console.error("Error reading search history:",n),[]}},o.clearHistory=function(){localStorage.removeItem("searchHistory")},o.displayHistory=function(n,a){const i=o.getHistory();if(!i||i.length===0){n.addClass("hidden").empty();return}let e='<div class="search-history-container">';e+='<div class="search-history-items">',i.forEach(function(c){e+='<div class="search-history-item" data-term="'+utils.escapeHTML(c)+'">',e+='<svg class="search-history-icon" width ="16" height="16" viewBox="0 0 24 24" fill="none" stroke = "currentColor" stroke-width="2">',e+='<circle cx="12" cy="12" r="10"></circle>',e+='<polyline points="12 6 12 12 16 14"></polyline>',e+="</svg>",e+='<span class="search-history-text">'+utils.escapeHTML(c)+"</span>",e+="</div>"}),e+="</div>",e+='<div class="search-history-clear">',e+='<button class="clear-history-btn">Clear search history</button>',e+="</div>",e+="</div>",n.removeClass("hidden").html(e),n.find(".search-history-item").on("click",function(){const c=$(this).data("term");a.val(c),a.closest("form").trigger("submit")}),n.find(".clear-history-btn").on("click",function(c){c.preventDefault(),c.stopPropagation(),o.clearHistory(),n.addClass("hidden"),a.trigger("focus")})},o.init=function(n){if(!config.searchEnabled)return;n=n||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((i,e)=>{v($(e),n)}),$(document).on("focus",'[component="search/fields"] input[name="query"]',function(){var i=$(this),e=i.closest('[component="search/fields"]').find("#quick-search-container"),c=i.val();(!c||c.length===0)&&(o.displayHistory(e,i),e.css({display:"block",visibility:"visible"}))})},o.showHistoryDropdown=function(n,a,i){o.displayHistory(n,a)};function v(n,a){const i=n.find('[component="search/button"]'),e=n.find('[component="search/fields"]'),c=e.find('input[name="query"]'),f=e.find("#quick-search-container"),I=e.hasClass("hidden"),D=/^(@|acct:)?[\w-]+@.+$/;I&&e.off("focusout").on("focusout",function(){setTimeout(function(){e.find(":focus").length||(e.addClass("hidden"),i.removeClass("hidden"))},200)}),c.off("focus");const _={inputEl:c,resultEl:f};o.enableQuickSearch({searchOptions:a,searchElements:_}),i.off("click").on("click",function(E){return!config.loggedIn&&!app.user.privileges["search:content"]?(u.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(E.stopPropagation(),o.showAndFocusInput(n),!1)}),n.off("submit").on("submit",function(){const E=$(this).find('input[name="query"]'),T=o.getSearchPreferences();return T.term=E.val(),T.in=a.in,o.saveToHistory(T.term),D.test(T.term)&&(T.in="users"),s.fire("action:search.submit",{searchOptions:T,searchElements:_}),o.query(T,function(){E.val(""),c.trigger("blur")}),!1})}o.enableQuickSearch=function(n){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const a=Object.assign({in:config.searchDefaultInQuick||"titles"},n.searchOptions),i=n.searchElements.resultEl,e=n.searchElements.inputEl;let c=e.val();const f=i.find(".filter-category");function I(){ajaxify.data.template.category&&ajaxify.data.cid&&h.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(b){const A=$("<div></div>").html(b).text();f.find(".name").text(A)}),f.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function D(){n.searchOptions=Object.assign({},a),n.searchOptions.term=e.val(),I(),ajaxify.data.template.category&&ajaxify.data.cid&&f.find('input[type="checkbox"]').is(":checked")&&(n.searchOptions.categories=[ajaxify.data.cid],n.searchOptions.searchChildren=!0),n.hideDuringSearch||(i.removeClass("hidden").find(".quick-search-results-container").html(""),i.find(".loading-indicator").removeClass("hidden")),s.fire("action:search.quick.start",n),n.searchOptions.searchOnly=1,o.api(n.searchOptions,function(b){if(i.find(".loading-indicator").addClass("hidden"),n.searchOptions.in==="categories"){if(!b.categories||n.hideOnNoMatches&&!b.categories.length)return i.addClass("hidden").find(".quick-search-results-container").html("");b.dropdown={maxWidth:"400px",maxHeight:"500px",...n.dropdown},app.parseAndTranslate("partials/quick-category-search-results",b,A=>{A.length&&A.find(".timeago").timeago(),i.toggleClass("hidden",!A.length||!e.is(":focus")).find(".quick-search-results-container").html(A.length?A:""),s.fire("action:search.quick.complete",{data:b,options:n})})}else{if(!b.posts||n.hideOnNoMatches&&!b.posts.length)return i.addClass("hidden").find(".quick-search-results-container").html("");b.posts.forEach(function(A){const R=$("<div>"+A.content+"</div>").text(),F=e.val().toLowerCase().replace(/^in:topic-\d+/,""),N=Math.max(0,R.toLowerCase().indexOf(F)-40);A.snippet=utils.escapeHTML((N>0?"...":"")+R.slice(N,N+80)+(R.length-N>80?"...":""))}),b.dropdown={maxWidth:"400px",maxHeight:"500px",...n.dropdown},app.parseAndTranslate("partials/quick-search-results",b,function(A){A.length&&A.find(".timeago").timeago(),i.toggleClass("hidden",!A.length||!e.is(":focus")).find(".quick-search-results-container").html(A.length?A:"");const R=i.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");o.highlightMatches(n.searchOptions.term,R),s.fire("action:search.quick.complete",{data:b,options:n})})}})}i.find('.filter-category input[type="checkbox"]').on("change",function(){e.focus(),D()}),e.off("keyup").on("keyup",utils.debounce(function(){if(e.val().length<3){i.addClass("hidden"),c=e.val();return}if(e.val()!==c){if(c=e.val(),!e.is(":focus"))return i.addClass("hidden");D()}},500)),i.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){i.addClass("hidden")})});const _=e.parent(),E=i.parent();_.on("focusout",T),E.on("focusout",T);function T(){setTimeout(function(){!_.find(":focus").length&&!E.find(":focus").length&&!i.hasClass("hidden")&&i.addClass("hidden")},200)}let H=!1;s.on("action:ajaxify.end",function(){ajaxify.isCold()||(H=!0),i.addClass("hidden")}),e.on("focus",function(){console.log("focus on fired event");const b=e.val();if(c=b,!b||b.length===0){o.showHistoryDropdown(i,e,a);return}b&&i.find("#quick-search-results").children().length&&(I(),H?(D(),H=!1):i.removeClass("hidden"),e[0].setSelectionRange(b.startsWith("in:topic")?b.indexOf(" ")+1:0,b.length))}),e.off("refresh").on("refresh",function(){D()})},o.showAndFocusInput=function(n){const a=n.parents(".dropdown-menu");if(a.length){const i=a.siblings("[data-bs-toggle]"),e=y.Dropdown.getOrCreateInstance(i[0]);e&&e.show()}else n.find('[component="search/fields"]').removeClass("hidden"),n.find('[component="search/button"]').addClass("hidden"),n.find('[component="search/fields"] input[name="query"]').trigger("focus")},o.query=function(n,a){a=a||function(){},ajaxify.go("search?"+w(n),a)},o.api=function(n,a){const i=config.relative_path+"/api/search?"+w(n);n.hasOwnProperty("searchOnly")&&delete n.searchOnly;const e=config.relative_path+"/search?"+w(n);$.get(i,function(c){c.url=e,a(c)})};function w(n){const a=n.in||"titles",i=n.term.replace(/^[ ?#]*/,""),e={...n,term:i,in:a};return s.fire("action:search.createQueryString",{query:e,data:n}),$.param(e)}return o.getSearchPreferences=function(){try{return JSON.parse(p.getItem("search-preferences")||"{}")}catch(n){return console.error(n),{}}},o.highlightMatches=function(n,a){if(!n||!a.length)return;n=utils.escapeHTML(n.replace(/^"/,"").replace(/"$/,"").trim());const i=n.split(" ").filter(c=>c.length>1).map(function(c){return utils.escapeRegexChars(c)}).join("|"),e=new RegExp("("+i+")","gi");a.each(function(){const c=$(this),f=[];c.find("*").each(function(){$(this).after("<!-- "+f.length+" -->"),f.push($("<div></div>").append($(this)))}),c.html(c.html().replace(e,function(I,D){return'<strong class="search-match fw-bold text-decoration-underline">'+D+"</strong>"})),f.forEach(function(I,D){c.html(c.html().replace("<!-- "+D+" -->",function(){return I.html()}))})}),$(".search-results .content").find("img:not(.not-responsive)").addClass("img-fluid")},o}).apply(C,g),d!==void 0&&(k.exports=d)},71949(k,C,l){var g;g=(function(){const d={};d.prepareDOM=function(){const s=$('[component="notifications"] [data-bs-toggle="dropdown"]');s.on("show.bs.dropdown",async u=>{const y=await app.require("notifications"),o=$(u.target);y.loadNotifications(o,o.parent().find('[component="notifications/list"]'))}),s.each((u,y)=>{const o=$(y),v=o.parent().find(".dropdown-menu");v.hasClass("show")&&app.require("notifications").then(w=>{w.loadNotifications(o,v.find('[component="notifications/list"]'))})}),socket.removeListener("event:new_notification",h),socket.on("event:new_notification",h),socket.removeListener("event:notifications.updateCount",p),socket.on("event:notifications.updateCount",p)};async function h(s){(await app.require("notifications")).onNewNotification(s)}async function p(s){(await app.require("notifications")).updateNotifCount(s)}return d}).call(C,l,C,k),g!==void 0&&(k.exports=g)},86174(k,C,l){var g,d;g=[l(19046),l(71949),l(11599),l(29930)],d=(function(h,p,s,u){const y={};y.prepareDOM=function(){app.user.uid>0&&h.initUnreadTopics(),p.prepareDOM(),s.prepareDOM(),o(),v(),w()};function o(){$('[component="header/usercontrol"] [data-status]').off("click").on("click",function(n){const a=$(this).attr("data-status");socket.emit("user.setStatus",a,function(i){if(i)return u.error(i);$('[data-uid="'+app.user.uid+'"] [component="user/status"], [component="header/profilelink"] [component="user/status"]').removeClass("away online dnd offline").addClass(a),$('[component="header/usercontrol"] [data-status]').each(function(){$(this).toggleClass("selected",$(this).attr("data-status")===a)}),app.user.status=a}),n.preventDefault()})}function v(){const n=utils.findBootstrapEnvironment();if(n==="xs"||n==="sm"||utils.isTouchDevice())return;const a=$("#header-menu .nav-item[title]");a.tooltip({trigger:"manual",animation:!1,placement:"bottom"}),a.on("mouseenter",function(i){const e=$(i.target);e.hasClass("dropdown-menu")||e.parents(".dropdown-menu").length||$(this).tooltip("show")}),a.on("click mouseleave",function(){$(this).tooltip("hide")})}function w(){$("body").on("click",'[component="user/logout"]',function(){return l.e(20739).then(function(){var n=[l(75427)];(function(a){a()}).apply(null,n)}).catch(l.oe),!1})}return y}).apply(C,g),d!==void 0&&(k.exports=d)}}]);
