(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5785,33085,34405,61861,69749,87212,92717,97650],{10870(m,v,c){"use strict";var y,h;y=[c(33530),c(17459),c(68636),c(29930),c(91749)],h=(function(p,u,o,l,f){const t={};let r,d;t.show=function(){f.one("action:ajaxify.end",()=>{a(),e(),t.showEmailConfirmWarning()})},t.showEmailConfirmWarning=function(i){if(!config.emailPrompt||!app.user.uid||parseInt(o.getItem("email-confirm-dismiss"),10)===1)return;const n={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{o.setItem("email-confirm-dismiss",1)}};!app.user.email&&!app.user.isEmailConfirmSent?(n.message="[[error:no-email-to-confirm]]",n.clickfn=function(){l.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},l.alert(n)):!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(n.message=i||"[[error:email-not-confirmed]]",n.clickfn=function(){l.remove("email_confirm"),ajaxify.go("/me/edit/email")},l.alert(n)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(n.message="[[error:email-not-confirmed-email-sent]]",l.alert(n))};function e(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||o.getItem("cookieconsent")==="1"||(config.cookies.message=u.unescape(config.cookies.message),config.cookies.dismiss=u.unescape(config.cookies.dismiss),config.cookies.link=u.unescape(config.cookies.link),config.cookies.link_url=u.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(i){$(document.body).append(i),$(document.body).addClass("cookie-consent-open");const n=$(".cookie-consent");n.find("button").on("click",function(){o.setItem("cookieconsent","1"),n.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function a(){const i=utils.params({full:!0});r=i.has("loggedin"),d=i.get("register"),r&&(l.alert({type:"success",title:"[[global:welcome-back]] "+app.user.username+"!",message:"[[global:you-have-successfully-logged-in]]",timeout:5e3}),i.delete("loggedin")),d&&(p.alert({message:utils.escapeHTML(decodeURIComponent(d))}),i.delete("register")),i.has("lang")&&i.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${i.get("lang")}", but that is already the forum default language.`),i.delete("lang"));const n=i.toString();ajaxify.updateHistory(ajaxify.currentPage+(n?`?${n}`:"")+document.location.hash,!0)}return t.showInvalidSession=function(){p.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},t.showSessionMismatch=function(){p.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},t}).apply(v,y),h!==void 0&&(m.exports=h)},13342(m,v,c){m.exports=c(41644)},31494(m,v,c){m.exports=c(36244)},34405(m,v,c){"use strict";var y,h;y=[c(49897),c(29930),c(36e3),c(9787),c(35786)],h=(function(p,u,{Textcomplete:o},{TextareaEditor:l},{ContenteditableEditor:f}){const t={},r={delay:200,appendTo:null};t.init=e=>{const a={...r,...e},{input:i,onSelect:n}=a;app.loadJQueryUI(function(){i.autocomplete({...a,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(s,g){d(i,n,s,g)}})})},t.user=function(e,a,i){typeof a=="function"&&(i=a,a={}),a=a||{},t.init({input:e,onSelect:i,source:(n,s)=>{a.query=n.term,p.get("/api/users",a,function(g,C){if(g)return u.error(g);if(C&&C.users){const E=C.users.map(function(b){const k=$("<div></div>").html(b.username).text();return b&&{label:k,value:k,user:{uid:b.uid,name:b.username,slug:b.userslug,username:b.username,userslug:b.userslug,displayname:b.displayname,picture:b.picture,banned:b.banned,"icon:text":b["icon:text"],"icon:bgColor":b["icon:bgColor"]}}});s(E)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},t.group=function(e,a){t.init({input:e,onSelect:a,source:(i,n)=>{socket.emit("groups.search",{query:i.term},function(s,g){if(s)return u.error(s);if(g&&g.length){const C=g.map(function(E){return E&&{label:E.name,value:E.name,group:E}});n(C)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},t.tag=function(e,a){t.init({input:e,onSelect:a,delay:100,source:(i,n)=>{socket.emit("topics.autocompleteTags",{query:i.term,cid:ajaxify.data.cid||0},function(s,g){if(s)return u.error(s);g&&n(g),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function d(e,a,i,n){a=a||function(){};const s=jQuery.Event("keypress");s.which=13,s.keyCode=13,setTimeout(function(){e.trigger(s)},100),a(i,n)}return t.setup=function({element:e,strategies:a,options:i}){const n=e.get(0);if(n){var s;if(n.nodeName==="TEXTAREA"||n.nodeName==="INPUT"?s=new l(n):n.nodeName==="DIV"&&n.getAttribute("contenteditable")==="true"&&(s=new f(n)),!s)throw new Error("unknown target element type");n.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var g=new o(s,a,{dropdown:i});return g.on("rendered",function(){g.dropdown.items.length&&g.dropdown.items[0].activate()}),g}},t}).apply(v,y),h!==void 0&&(m.exports=h)},41088(m,v,c){"use strict";var y;y=(function(){const h={};return h.apply=function(p){$(p).on("mousewheel",function(u){const o=this.scrollTop,l=this.scrollHeight,f=Math.round(this.getBoundingClientRect().height);if(u.originalEvent.deltaY<0&&o===0||u.originalEvent.deltaY>0&&f+o>=l)return!1})},h}).call(v,c,v,m),y!==void 0&&(m.exports=y)},43103(m,v,c){"use strict";var y,h;y=[c(29930)],h=(function(p){const u={};return u.init=function(o){const l=o.uploadFormEl;if(l.length&&(l.attr("action",config.relative_path+o.route),o.dragDropAreaEl&&u.handleDragDrop({container:o.dragDropAreaEl,callback:function(f){u.ajaxSubmit({uploadForm:l,upload:f,callback:o.callback})}}),o.pasteEl&&u.handlePaste({container:o.pasteEl,callback:function(f){u.ajaxSubmit({uploadForm:l,upload:f,callback:o.callback})}}),o.uploadBtnEl)){const f=l.find('input[name="files[]"]');o.uploadBtnEl.on("click",function(){return f.trigger("click"),!1}),f.on("change",function(t){const r=(t.target||{}).files||($(this).val()?[{name:$(this).val(),type:utils.fileMimeType($(this).val())}]:null);r&&u.ajaxSubmit({uploadForm:l,upload:{files:r,fileNames:Array.from(r).map(d=>d.name)},callback:o.callback})})}},u.handleDragDrop=function(o){let l=!1;const f=o.container,t=o.container.find(".imagedrop");f.on("dragenter",function(){l||(t.css("top","0px"),t.css("height",f.height()+"px"),t.css("line-height",f.height()+"px"),t.show(),t.on("dragleave",function(){t.hide(),t.off("dragleave")}))}),t.on("drop",function(e){e.preventDefault();const a=e.originalEvent.dataTransfer.files;if(a.length){let n;if(window.FormData){n=new FormData;for(var i=0;i<a.length;++i)n.append("files[]",a[i],a[i].name)}o.callback({files:a,formData:n})}return t.hide(),!1});function r(d){return d.preventDefault(),!1}$(document).off("dragstart").on("dragstart",function(){l=!0}).off("dragend").on("dragend, mouseup",function(){l=!1}),t.on("dragover",r),t.on("dragenter",r)},u.handlePaste=function(o){o.container.on("paste",function(f){const t=(f.clipboardData||f.originalEvent.clipboardData||{}).items,r=[],d=[];let e=null;window.FormData&&(e=new FormData),[].forEach.call(t,function(a){const i=a.getAsFile();if(i){const n=utils.generateUUID()+"-"+i.name;e&&e.append("files[]",i,n),r.push(i),d.push(n)}}),r.length&&o.callback({files:r,fileNames:d,formData:e})})},u.ajaxSubmit=function(o){const l=[...o.upload.files];for(let t=0;t<l.length;++t){const r=l[t].type.match(/image./);if(r&&!app.user.privileges["upload:post:image"]||!r&&!app.user.privileges["upload:post:file"])return p.error("[[error:no-privileges]]");if(!app.user.isAdmin&&l[t].size>parseInt(config.maximumFileSize,10)*1024)return o.uploadForm[0].reset(),p.error("[[error:file-too-big, "+config.maximumFileSize+"]]")}const f=Date.now();o.uploadForm.off("submit").on("submit",function(){return $(this).ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},resetForm:!0,clearForm:!0,formData:o.upload.formData,error:function(t){let r=t.responseJSON&&(t.responseJSON.error||t.responseJSON.status&&t.responseJSON.status.message)||"[[error:parse-error]]";t&&t.status===413&&(r=t.statusText||"Request Entity Too Large"),p.error(r),p.remove(f)},uploadProgress:function(t,r,d,e){p.alert({alert_id:f,message:"[[modules:composer.uploading, "+e+"%]]"})},success:function(t){const r=t.response.images;if(r&&r.length)for(var d=0;d<r.length;++d)r[d].filename=l[d].name,r[d].isImage=/image./.test(l[d].type);o.callback(r)},complete:function(){o.uploadForm[0].reset(),setTimeout(p.remove,100,f)}}),!1}),o.uploadForm.submit()},u}).apply(v,y),h!==void 0&&(m.exports=h)},52543(m,v,c){m.exports=c(28721)},65348(m,v,c){"use strict";var y,h;y=[c(96349),c(33530),c(91749),c(17459)],h=(function(p,u,o,l){const f={};return f.init=function(t,r){if(!t||!t.length)return;r=r||{};const d=r.onSelect||function(){};r.states=r.states||["watching","tracking","notwatching","ignoring"],r.template=r.template||"partials/category/selector-dropdown-left",o.fire("action:category.selector.options",{el:t,options:r}),p.init(t,r);const e={el:t,selectedCategory:null};t.on("click","[data-cid]",function(){const i=$(this);return i.hasClass("disabled")?!1:(e.selectCategory(i.attr("data-cid")),d(e.selectedCategory))});let a=e.el.find('[component="category-selector-selected"]').html();return l.translate(a,i=>{a=i}),e.selectCategory=function(i){const n=e.el.find('[data-cid="'+i+'"]');e.selectedCategory={cid:i,name:n.attr("data-name")},n.length?e.el.find('[component="category-selector-selected"]').html(n.find('[component="category-markup"]').html()):e.el.find('[component="category-selector-selected"]').html(a)},e.getSelectedCategory=function(){return e.selectedCategory},e.getSelectedCid=function(){return e.selectedCategory?e.selectedCategory.cid:0},r.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(r.template,{selectedCategory:r.selectedCategory},function(i){e.el.find('[component="category-selector-selected"]').html(i.find('[component="category-selector-selected"]').html())}),e},f.modal=function(t){t=t||{},t.onSelect=t.onSelect||function(){},t.onSubmit=t.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:t.message},function(r){const d=u.dialog({title:t.title||"[[modules:composer.select-category]]",message:r,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:a}}}),e=f.init(d.find('[component="category-selector"]'),t);function a(i){return i.preventDefault(),e.selectedCategory&&(t.onSubmit(e.selectedCategory),d.modal("hide")),!1}t.openOnLoad&&d.on("shown.bs.modal",function(){d.find(".dropdown-toggle").dropdown("toggle")}),d.find("form").on("submit",a)})},f}).apply(v,y),h!==void 0&&(m.exports=h)},68636(m,v,c){"use strict";var y;y=(function(){function h(){this._store={},this._keys=[]}h.prototype.isMock=!0,h.prototype.setItem=function(o,l){o=String(o),this._keys.indexOf(o)===-1&&this._keys.push(o),this._store[o]=l},h.prototype.getItem=function(o){return o=String(o),this._keys.indexOf(o)===-1?null:this._store[o]},h.prototype.removeItem=function(o){o=String(o),this._keys=this._keys.filter(function(l){return l!==o}),this._store[o]=null},h.prototype.clear=function(){this._keys=[],this._store={}},h.prototype.key=function(o){return o=parseInt(o,10)||0,this._keys[o]},Object.defineProperty&&Object.defineProperty(h.prototype,"length",{get:function(){return this._keys.length}});let p;const u=Date.now().toString();try{if(p=window.localStorage,p.setItem(u,u),p.getItem(u)!==u)throw Error("localStorage behaved unexpectedly");return p.removeItem(u),p}catch(o){console.warn(o),console.warn("localStorage failed, falling back on sessionStorage");try{if(p=window.sessionStorage,p.setItem(u,u),p.getItem(u)!==u)throw Error("sessionStorage behaved unexpectedly");return p.removeItem(u),p}catch(l){return console.warn(l),console.warn("sessionStorage failed, falling back on memory storage"),new h}}}).call(v,c,v,m),y!==void 0&&(m.exports=y)},69749(m,v,c){"use strict";var y,h;y=[c(17459),c(68636),c(91749),c(29930),c(89336),c(77918)],h=(function(p,u,o,l,f){const t={current:{}};t.saveToHistory=function(e){if(!e||e.length<2)return;let a=JSON.parse(localStorage.getItem("searchHistory")||"[]");a=a.filter(i=>i!==e),a.unshift(e),a=a.slice(0,8),u.setItem("searchHistory",JSON.stringify(a))},t.getHistory=function(){try{return JSON.parse(localStorage.getItem("searchHistory")||"[]")}catch(e){return console.error("Error reading search history:",e),[]}},t.clearHistory=function(){localStorage.removeItem("searchHistory")},t.displayHistory=function(e,a){const i=t.getHistory();if(!i||i.length===0){e.addClass("hidden").empty();return}let n='<div class="search-history-container">';n+='<div class="search-history-items">',i.forEach(function(s){n+='<div class="search-history-item" data-term="'+utils.escapeHTML(s)+'">',n+='<svg class="search-history-icon" width ="16" height="16" viewBox="0 0 24 24" fill="none" stroke = "currentColor" stroke-width="2">',n+='<circle cx="12" cy="12" r="10"></circle>',n+='<polyline points="12 6 12 12 16 14"></polyline>',n+="</svg>",n+='<span class="search-history-text">'+utils.escapeHTML(s)+"</span>",n+="</div>"}),n+="</div>",n+='<div class="search-history-clear">',n+='<button class="clear-history-btn">Clear search history</button>',n+="</div>",n+="</div>",e.removeClass("hidden").html(n),e.find(".search-history-item").on("click",function(){const s=$(this).data("term");a.val(s),a.closest("form").trigger("submit")}),e.find(".clear-history-btn").on("click",function(s){s.preventDefault(),s.stopPropagation(),t.clearHistory(),e.addClass("hidden"),a.trigger("focus")})},t.init=function(e){if(!config.searchEnabled)return;e=e||{in:config.searchDefaultInQuick||"titles"},$('[component="search/form"]').each((i,n)=>{r($(n),e)}),$(document).on("focus",'[component="search/fields"] input[name="query"]',function(){var i=$(this),n=i.closest('[component="search/fields"]').find("#quick-search-container"),s=i.val();(!s||s.length===0)&&(t.displayHistory(n,i),n.css({display:"block",visibility:"visible"}))})},t.showHistoryDropdown=function(e,a,i){t.displayHistory(e,a)};function r(e,a){const i=e.find('[component="search/button"]'),n=e.find('[component="search/fields"]'),s=n.find('input[name="query"]'),g=n.find("#quick-search-container"),C=n.hasClass("hidden"),E=/^(@|acct:)?[\w-]+@.+$/;C&&n.off("focusout").on("focusout",function(){setTimeout(function(){n.find(":focus").length||(n.addClass("hidden"),i.removeClass("hidden"))},200)}),s.off("focus");const b={inputEl:s,resultEl:g};t.enableQuickSearch({searchOptions:a,searchElements:b}),i.off("click").on("click",function(k){return!config.loggedIn&&!app.user.privileges["search:content"]?(l.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1):(k.stopPropagation(),t.showAndFocusInput(e),!1)}),e.off("submit").on("submit",function(){const k=$(this).find('input[name="query"]'),S=t.getSearchPreferences();return S.term=k.val(),S.in=a.in,t.saveToHistory(S.term),E.test(S.term)&&(S.in="users"),o.fire("action:search.submit",{searchOptions:S,searchElements:b}),t.query(S,function(){k.val(""),s.trigger("blur")}),!1})}t.enableQuickSearch=function(e){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const a=Object.assign({in:config.searchDefaultInQuick||"titles"},e.searchOptions),i=e.searchElements.resultEl,n=e.searchElements.inputEl;let s=n.val();const g=i.find(".filter-category");function C(){ajaxify.data.template.category&&ajaxify.data.cid&&p.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",function(x){const w=$("<div></div>").html(x).text();g.find(".name").text(w)}),g.toggleClass("hidden",!(ajaxify.data.template.category&&ajaxify.data.cid))}function E(){e.searchOptions=Object.assign({},a),e.searchOptions.term=n.val(),C(),ajaxify.data.template.category&&ajaxify.data.cid&&g.find('input[type="checkbox"]').is(":checked")&&(e.searchOptions.categories=[ajaxify.data.cid],e.searchOptions.searchChildren=!0),e.hideDuringSearch||(i.removeClass("hidden").find(".quick-search-results-container").html(""),i.find(".loading-indicator").removeClass("hidden")),o.fire("action:search.quick.start",e),e.searchOptions.searchOnly=1,t.api(e.searchOptions,function(x){if(i.find(".loading-indicator").addClass("hidden"),e.searchOptions.in==="categories"){if(!x.categories||e.hideOnNoMatches&&!x.categories.length)return i.addClass("hidden").find(".quick-search-results-container").html("");x.dropdown={maxWidth:"400px",maxHeight:"500px",...e.dropdown},app.parseAndTranslate("partials/quick-category-search-results",x,w=>{w.length&&w.find(".timeago").timeago(),i.toggleClass("hidden",!w.length||!n.is(":focus")).find(".quick-search-results-container").html(w.length?w:""),o.fire("action:search.quick.complete",{data:x,options:e})})}else{if(!x.posts||e.hideOnNoMatches&&!x.posts.length)return i.addClass("hidden").find(".quick-search-results-container").html("");x.posts.forEach(function(w){const D=$("<div>"+w.content+"</div>").text(),I=n.val().toLowerCase().replace(/^in:topic-\d+/,""),A=Math.max(0,D.toLowerCase().indexOf(I)-40);w.snippet=utils.escapeHTML((A>0?"...":"")+D.slice(A,A+80)+(D.length-A>80?"...":""))}),x.dropdown={maxWidth:"400px",maxHeight:"500px",...e.dropdown},app.parseAndTranslate("partials/quick-search-results",x,function(w){w.length&&w.find(".timeago").timeago(),i.toggleClass("hidden",!w.length||!n.is(":focus")).find(".quick-search-results-container").html(w.length?w:"");const D=i.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");t.highlightMatches(e.searchOptions.term,D),o.fire("action:search.quick.complete",{data:x,options:e})})}})}i.find('.filter-category input[type="checkbox"]').on("change",function(){n.focus(),E()}),n.off("keyup").on("keyup",utils.debounce(function(){if(n.val().length<3){i.addClass("hidden"),s=n.val();return}if(n.val()!==s){if(s=n.val(),!n.is(":focus"))return i.addClass("hidden");E()}},500)),i.on("mousedown",".quick-search-results > *",function(){$(window).one("mouseup",function(){i.addClass("hidden")})});const b=n.parent(),k=i.parent();b.on("focusout",S),k.on("focusout",S);function S(){setTimeout(function(){!b.find(":focus").length&&!k.find(":focus").length&&!i.hasClass("hidden")&&i.addClass("hidden")},200)}let _=!1;o.on("action:ajaxify.end",function(){ajaxify.isCold()||(_=!0),i.addClass("hidden")}),n.on("focus",function(){console.log("focus on fired event");const x=n.val();if(s=x,!x||x.length===0){t.showHistoryDropdown(i,n,a);return}x&&i.find("#quick-search-results").children().length&&(C(),_?(E(),_=!1):i.removeClass("hidden"),n[0].setSelectionRange(x.startsWith("in:topic")?x.indexOf(" ")+1:0,x.length))}),n.off("refresh").on("refresh",function(){E()})},t.showAndFocusInput=function(e){const a=e.parents(".dropdown-menu");if(a.length){const i=a.siblings("[data-bs-toggle]"),n=f.Dropdown.getOrCreateInstance(i[0]);n&&n.show()}else e.find('[component="search/fields"]').removeClass("hidden"),e.find('[component="search/button"]').addClass("hidden"),e.find('[component="search/fields"] input[name="query"]').trigger("focus")},t.query=function(e,a){a=a||function(){},ajaxify.go("search?"+d(e),a)},t.api=function(e,a){const i=config.relative_path+"/api/search?"+d(e);e.hasOwnProperty("searchOnly")&&delete e.searchOnly;const n=config.relative_path+"/search?"+d(e);$.get(i,function(s){s.url=n,a(s)})};function d(e){const a=e.in||"titles",i=e.term.replace(/^[ ?#]*/,""),n={...e,term:i,in:a};return o.fire("action:search.createQueryString",{query:n,data:e}),$.param(n)}return t.getSearchPreferences=function(){try{return JSON.parse(u.getItem("search-preferences")||"{}")}catch(e){return console.error(e),{}}},t.highlightMatches=function(e,a){if(!e||!a.length)return;e=utils.escapeHTML(e.replace(/^"/,"").replace(/"$/,"").trim());const i=e.split(" ").filter(s=>s.length>1).map(function(s){return utils.escapeRegexChars(s)}).join("|"),n=new RegExp("("+i+")","gi");a.each(function(){const s=$(this),g=[];s.find("*").each(function(){$(this).after("<!-- "+g.length+" -->"),g.push($("<div></div>").append($(this)))}),s.html(s.html().replace(n,function(C,E){return'<strong class="search-match fw-bold text-decoration-underline">'+E+"</strong>"})),g.forEach(function(C,E){s.html(s.html().replace("<!-- "+E+" -->",function(){return C.html()}))})}),$(".search-results .content").find("img:not(.not-responsive)").addClass("img-fluid")},t}).apply(v,y),h!==void 0&&(m.exports=h)},71431(m,v,c){m.exports=c(49641)},72573(m,v,c){m.exports=c(59367)},88518(m,v,c){m.exports=c(54516)},92762(m,v,c){m.exports=c(94252)},96349(m,v,c){"use strict";var y,h;y=[c(29930),c(89336),c(49897)],h=(function(p,u,o){const l={};return l.init=function(f,t){let r=t.defaultCategories||null;t=t||{},t.privilege=t.privilege||"topics:read",t.states=t.states||["watching","tracking","notwatching","ignoring"],t.cacheList=t.hasOwnProperty("cacheList")?t.cacheList:!0;let d=[];Array.isArray(t.localCategories)&&(d=t.localCategories.map(s=>({...s})),r&&(r=[...d,...r])),t.selectedCids=t.selectedCids||ajaxify.data.selectedCids||[];const e=f.find('[component="category-selector-search"]');if(!e.length)return;const a=e.parents('[component="category/dropdown"]').length>0||e.parents('[component="category-selector"]').length>0;f.on("show.bs.dropdown",function(){a&&e.removeClass("hidden");function s(){const g=e.find("input").val();g.length>1||!g&&!r?i(g,function(C){r=t.cacheList&&(r||C),n(C)}):!g&&r&&n(r)}e.on("click",function(g){g.preventDefault(),g.stopPropagation()}),e.find("input").val("").on("keyup",utils.debounce(s,300)),s()}),f.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||e.find("input").focus()}),f.on("hide.bs.dropdown",function(){a&&e.addClass("hidden"),e.off("click"),e.find("input").off("keyup")});function i(s,g){o.get("/search/categories",{search:s,query:utils.params(),parentCid:t.parentCid||0,selectedCids:t.selectedCids,privilege:t.privilege,states:t.states,showLinks:t.showLinks,localOnly:t.localOnly,hideUncategorized:t.hideUncategorized},function(C,{categories:E}){if(C)return p.error(C);g(d.concat(E))})}function n(s){const g=t.selectedCids.map(String);s.forEach(function(C){C.selected=g.includes(String(C.cid))}),app.parseAndTranslate(t.template,{categoryItems:s.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl,hideAll:t.hideAll},function(C){f.find('[component="category/list"]').html(C.find('[component="category/list"]').html()),f.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!s.length);const E=u.Dropdown.getInstance(f.find(".dropdown-toggle").get(0));E&&E.update()})}},l}).apply(v,y),h!==void 0&&(m.exports=h)}}]);
